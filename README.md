# Otolith13C_hypoxia
Overview:
Scripts and processed variables for 'Hypoxia traits imprinted in otolith δ13C from individual to global scales' (Howard and Deutsch 2024). The versions of record for the manuscript are from April 26th, 2024. Any future versions with substantive changes will be added to this repository with new dates in the file name. All databases and scripts are for use with Matlab, but are largely interoperable with the freeware GNU Octave.

No express or implied warranty: These scripts, helper functions, and data tables are provided "as is," without warranty or guarantee of any kind. 

File descriptions:

Each primary script (HowardDeutsch_...) processes data and generates key figures and statistics from the associated manuscript.
a. HowardDeutsch_InternalCarbon processes observations of inorganic carbon system measurements from the environment and internal to a given organism to calculate pCO2. 
b. HowardDeutsch_AtlanticCodCase processes measured isotopic compositions and hypoxia traits from Atlantic cod datasets to generate comparisons of hypoxia-based predictions and observed otolith isotopic composition at the species level.
c. HowardDeutsch_PacificCodCase generates a similified life history model for Pacific cod and associated predictions of otolith isotopic composition within individuals.
d. HowardDeutsch_Global combines observed distributions of hydrographic properties, hypoxia traits, and trophic levels across many species to generate predicted distributions of otolith isotopic compositions. 
e. HowardDeutsch_GlobalCase uses the fields generated by HowardDeutsch_Global to produce associated plots and statistics for the global case study across many species. 

The folder 'Helper_Scripts_and_files' contains data tables helper functions, and toolboxes called by the primary scripts. 
a. Allometry.mat is a table of the interspecific trend with size in allometric scaling exponents (this is not used in the current scripts).
b. BloodPint.mat is a table of experimentally determined internal and experimental inorganic carbonate system measurements various fishes.
c. C13speciation.m calculates the expected isotopic composition for each inorganic carbonate system chemical species based on the the measured isotopic composition of any other.
d. Deutsch2020Phist.mat is the interspecific distribution of Vh from respirometry, and two estimates of PhiCrit (~SMS) based on different biogeographic methods.
e. F5d13pdfZ_ct and F5d13pdf_ct are processed fields called by HowardDeutsch_GlobalCase, to save users time in regenerating plotted fields if they retain the same calculation assumptions chosen by the authors in HowardDeutsch_Global.
f. Gtr.mat is a trait database, and includes both distributions of hypoxia traits as well as the species-specific hypoxia trait estimates and underlying experimental metabolic rate and critical partial pressure of oxygen data. Specifically, Gtr.Par contains the individual species (named in Gtr.Par.Species_unq) trait parameters, including Eo (Gtr.Par.Eo), Vh (Gtr.Par.Ao; Ao-1=Vh), and SMS (Gtr.Par.phic; phic=SMS), as well as other metrics such as Emet (the metabolic temperature sensitivity only) and αD (the oxygen demand coefficient). The varied parameters available are more completely described in Deutsch et al. 2020 (https://doi.org/10.1038/s41586-020-2721-y) and Penn and Deutsch 2024 (https://doi.org/10.1098/rstb.2022.0487). Gtr.Par.P includes the underlying critical partial pressure of O2 data across temperature and mass (...P.temp, ...P.mass, …P.pcrit) and associated trait estimates (…P.est: Columns 1 and 2 are Vh-1 and Eo, respectively) and uncertainties and goodness of fit metrics (…P.err, …pval, …r2, etc.). Gtr.Par.M contains equivalent data and metrics based on metabolic rate alone rather than the ratio of oxygen supply and demand (hypoxia). The other top-level fields in Gtr represent binning vectors and empirical distributions of those traits across the trait database, which are called by the archived analysis scripts (see HowardDeutsch_Global for use examples). The hypoxia trait epislon is not included, and those interested are referred to Deutsch et al. 2022 (https://doi.org/10.1073/pnas.2201345119).
g. HaulInfo.mat includes NOAA haul documentation, animal size, and metadata associated with the Pacific Cod data called by HowardDeutsch_PacificCodCase.
h. HowardDeutsch_BloodMeasurements processes BloodPint to generate estimates of Pw, Pint, and Pmet.
i. HowardDeutsch_
